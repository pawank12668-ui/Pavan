<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pavan ki Dukan - Invoice</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  h1 { text-align: center; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  table, th, td { border: 1px solid #000; }
  th, td { padding: 10px; text-align: center; }
  select, input { padding: 5px; }
  button { padding: 5px 10px; margin-top: 10px; }
  .total { text-align: right; margin-top: 10px; font-weight: bold; }
</style>
</head>
<body>

<h1>Pavan ki Dukan</h1>

<table id="invoiceTable">
  <thead>
    <tr>
      <th>Item</th>
      <th>Quantity</th>
      <th>Unit</th>
      <th>Price per Unit</th>
      <th>Total</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <!-- Items automatically added here -->
  </tbody>
</table>

<div class="total">Grand Total: ₹<span id="grandTotal">0</span></div>
<button onclick="addItemRow()">Add Item</button>

<script>
// Pre-defined items
const itemsList = [
  { name: "Aata", pricePerKg: 40 },
  { name: "Chini", pricePerKg: 50 },
  { name: "colgate", pricePerKg: 20 },
  { name: "shanti aamla hair oil", pricePerKg: 45 },
  { name: "suji", pricePerKg: 30 },
  { name: "soyachunks", pricePerKg: 120 },
  { name: "namkeen", pricePerKg: 55 },
  { name: "Daal", pricePerKg: 120 },
  { name: "Tel", pricePerKg: 180 }
];

// Function to add a row
function addItemRow() {
  const tbody = document.querySelector("#invoiceTable tbody");
  const row = document.createElement("tr");

  // Item dropdown
  let itemOptions = `<option value="">Select</option>`;
  itemsList.forEach((item, index) => {
    itemOptions += `<option value="${index}">${item.name}</option>`;
  });

  row.innerHTML = `
    <td>
      <select onchange="updatePrice(this)">
        ${itemOptions}
      </select>
    </td>
    <td><input type="number" min="0" value="0" onchange="updateTotal(this)"></td>
    <td>
      <select onchange="updateTotal(this)">
        <option value="kg">KG</option>
        <option value="gm">GM</option>
      </select>
    </td>
    <td>₹<span class="price">0</span></td>
    <td>₹<span class="total">0</span></td>
    <td><button onclick="removeRow(this)">Remove</button></td>
  `;
  tbody.appendChild(row);
}

// Update price per unit when item is selected
function updatePrice(select) {
  const row = select.parentElement.parentElement;
  const priceSpan = row.querySelector(".price");
  const index = select.value;
  if(index !== "") {
    const price = itemsList[index].pricePerKg;
    priceSpan.innerText = price;
  } else {
    priceSpan.innerText = 0;
  }
  updateTotal(row.querySelector("input"));
}

// Update total for the row and grand total
function updateTotal(element) {
  const row = element.parentElement.parentElement;
  const qtyInput = row.querySelector("input");
  const unitSelect = row.querySelectorAll("select")[1];
  const price = parseFloat(row.querySelector(".price").innerText) || 0;
  let qty = parseFloat(qtyInput.value) || 0;

  if(unitSelect.value === "gm") {
    qty = qty / 1000; // convert gm to kg
  }

  const total = qty * price;
  row.querySelector(".total").innerText = total.toFixed(2);

  updateGrandTotal();
}

// Remove row
function removeRow(button) {
  button.parentElement.parentElement.remove();
  updateGrandTotal();
}

// Calculate grand total
function updateGrandTotal() {
  let grandTotal = 0;
  document.querySelectorAll(".total").forEach(span => {
    grandTotal += parseFloat(span.innerText) || 0;
  });
  document.getElementById("grandTotal").innerText = grandTotal.toFixed(2);
}

// Initialize with 2 rows
addItemRow();
addItemRow();
</script>

</body>
</html><!-- Print Button: Add यह जगह पर, </body> के पहले -->
<button onclick="printInvoice()">Print Invoice</button>

<script>
// Print function
function printInvoice() {
  // पहले, totals update कर दो ताकि print में latest value दिखे
  updateGrandTotal();
  // Browser का print dialog खोलो
  window.print();
}
</script>